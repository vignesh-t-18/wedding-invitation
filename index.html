<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Rahul ‚ù§Ô∏è Nivi ‚Äî Welcome</title>
  <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
  <style>
    :root{--deep1:#2b0533;--deep2:#3b0b56;--accent:#ff9fb3}
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;font-family:Poppins,system-ui,Arial;background:linear-gradient(180deg,var(--deep1),var(--deep2));display:flex;align-items:center;justify-content:center}
    .top-actions{position:fixed;left:12px;top:12px;z-index:1200}
    .top-actions-right{position:fixed;right:12px;top:12px;z-index:1200}
    .btn{background:#fff;padding:8px 12px;border-radius:8px;box-shadow:0 6px 18px rgba(0,0,0,0.12);border:none;cursor:pointer}
    .link{background:#fff;padding:8px 12px;border-radius:8px;box-shadow:0 6px 18px rgba(0,0,0,0.12);text-decoration:none;color:#333}
    .container{width:100%;max-width:980px;padding:48px 24px;text-align:center;color:rgba(255,255,255,0.95)}
    .initials{font-family:'Great Vibes', serif;font-size:140px;color:var(--accent);text-shadow:0 18px 40px rgba(0,0,0,0.45);opacity:0;transform:translateY(8px);transition:opacity .9s ease,transform .9s ease}
    .lead{font-size:20px;margin-top:6px;opacity:0;color:rgba(255,255,255,0.95);letter-spacing:0.6px}
    .line2{font-size:20px;margin-top:12px;opacity:0;color:rgba(255,255,255,0.9);font-weight:600}
    .progress-wrap{margin:36px auto 0;width:60%;height:8px;background:rgba(255,255,255,0.08);border-radius:6px;position:relative;overflow:hidden;opacity:0}
    .progress-bar{position:absolute;left:0;top:0;height:100%;width:0%;background:linear-gradient(90deg, rgba(255,159,179,1), rgba(255,255,255,0.9));box-shadow:0 6px 18px rgba(0,0,0,0.3);transition:width 3.6s linear}
    .progress-indicator{position:absolute;left:0;top:-6px;width:12px;height:20px;background:rgba(255,255,255,0.95);border-radius:4px;box-shadow:0 6px 18px rgba(0,0,0,0.35);transition:left 3.6s linear}
    .click-heart{display:inline-block;margin-left:8px;color:#ff7aa3;cursor:pointer;font-size:22px}
    @media(max-width:720px){.initials{font-size:96px}.progress-wrap{width:80%}}
    /* Side particle animation */
    #sideParticles{position:fixed;inset:0;pointer-events:none;z-index:900;overflow:hidden}
    .particle{position:absolute;will-change:transform,opacity;opacity:0;filter:drop-shadow(0 6px 18px rgba(0,0,0,0.25))}
    .particle.heart{background:radial-gradient(circle at 30% 30%, #ff9fb3, #ff5a8a);width:36px;height:32px;border-radius:40% 40% 40% 40%;transform:rotate(-45deg)}
    .particle.star{width:14px;height:14px;border-radius:50%;background:linear-gradient(90deg,#ffd76b,#ffb86b)}
    @keyframes floatAcross {
      0%{transform:translateY(0) translateX(0) scale(0.8);opacity:0}
      10%{opacity:1}
      100%{transform:translateY(-40vh) translateX(120vw) scale(1.1);opacity:0}
    }
    @keyframes floatAcrossLeft {
      0%{transform:translateY(0) translateX(0) scale(0.8);opacity:0}
      10%{opacity:1}
      100%{transform:translateY(-40vh) translateX(-120vw) scale(1.1);opacity:0}
    }
  </style>
</head>
<body>

  <div class="top-actions">
    <button id="audioToggle" class="btn" aria-pressed="false">Play Music</button>
  </div>
  <div class="top-actions-right">
    <a class="link" href="advanced-invitation.html">Open Advanced Invitation</a>
  </div>

  <audio id="pageAudio" autoplay playsinline loop preload="auto">
    <source src="Majnu-Bgm.mp3" type="audio/mpeg">
  </audio>

  <!-- Autoplay fallback overlay (shown when autoplay is blocked) -->
  <div id="playOverlay" style="position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:linear-gradient(0deg, rgba(0,0,0,0.55), rgba(0,0,0,0.35));z-index:1600">
    <button id="overlayPlayBtn" style="background:linear-gradient(90deg,#ff9fb3,#ff5a8a);color:white;border:none;padding:18px 26px;border-radius:12px;font-size:18px;cursor:pointer;box-shadow:0 10px 30px rgba(0,0,0,0.4)">Tap to Play Music</button>
  </div>

  <div class="container" role="main">
    <div class="initials" id="initials">R &amp; N</div>
    <div class="lead" id="lead">Hey there! <span class="click-heart" id="heartBtn">üíï</span></div>
    <div class="line2" id="line2">We're so excited to celebrate with you</div>

    <div class="progress-wrap" id="progressWrap" aria-hidden="true">
      <div class="progress-bar" id="progressBar"></div>
      <div class="progress-indicator" id="progressIndicator"></div>
    </div>
  </div>


  <!-- Side particle container -->
  <div id="sideParticles" aria-hidden="true"></div>

  <script>
    // Audio toggle and cross-page sync via localStorage
    (function(){
      const audio = document.getElementById('pageAudio');
      const btn = document.getElementById('audioToggle');
      // (localStorage removed) ‚Äî audio control handled locally per page

      async function playAudio(){
        try{
          audio.muted = false;
          audio.volume = 0.8; // start at 80% volume
          await audio.play();
          btn.textContent = 'Pause Music';
          btn.setAttribute('aria-pressed','true');
        }catch(e){
          // audible autoplay blocked ‚Äî try muted autoplay as a fallback
          try{
            audio.muted = false;
            audio.volume = 0;
            await audio.play();
            // show overlay prompting user to unmute
            showOverlayUnmute();
            // keep storage as play so other tabs can mirror
            // no-op: localStorage removed
          }catch(err){
            btn.textContent = 'Play Music';
            btn.setAttribute('aria-pressed','false');
          }
        }
      }
      function pauseAudio(){
        audio.pause();
        btn.textContent = 'Play Music';
        btn.setAttribute('aria-pressed','false');
      }

      btn.addEventListener('click', ()=>{ if(audio.paused) playAudio(); else pauseAudio(); });

      // On load: attempt autoplay (best-effort) and show overlay if blocked
      window.addEventListener('load', ()=>{ playAudio().catch(()=> showOverlay()); });

      // show overlay to prompt user when autoplay blocked
      const overlay = document.getElementById('playOverlay');
      const overlayBtn = document.getElementById('overlayPlayBtn');
      function showOverlay(){ if(overlay) overlay.style.display='flex'; }
      function hideOverlay(){ if(overlay) overlay.style.display='none'; }
      // specialized overlay flow for muted autoplay: prompt user to unmute
      function showOverlayUnmute(){
        if(!overlay) return;
        overlay.style.display = 'flex';
        overlayBtn.textContent = 'Tap to Unmute Music';
        overlayBtn.onclick = async function(){
          // unmute and fade in
          try{
            audio.muted = false;
            await fadeVolume(audio, 0.8, 600);
            btn.textContent = 'Pause Music';
            btn.setAttribute('aria-pressed','true');
            hideOverlay();
          }catch(e){ }
        };
      }
      overlayBtn && overlayBtn.addEventListener('click', ()=>{ playAudio(); hideOverlay(); });

      // fade helper
      function fadeVolume(el, target, duration){
        return new Promise((res)=>{
          const start = el.volume || 0;
          const diff = target - start;
          const stepMs = 50;
          const steps = Math.max(1, Math.round(duration/stepMs));
          let cur = 0;
          const iv = setInterval(()=>{
            cur++;
            el.volume = Math.min(1, start + diff * (cur/steps));
            if(cur >= steps){ clearInterval(iv); res(); }
          }, stepMs);
        });
      }

      // also listen for first user interaction as a chance to start audio
      ['pointerdown','keydown','touchstart','click'].forEach(evt=>{
        window.addEventListener(evt, function onFirst(){
          window.removeEventListener(evt, onFirst);
          // if audio is currently muted but playing (muted autoplay succeeded), unmute and fade
          if(!audio.paused && audio.muted){
            audio.muted = false;
            fadeVolume(audio, 0.8, 600).then(()=> hideOverlay()).catch(()=>{});
            return;
          }
          playAudio().then(()=> hideOverlay()).catch(()=>{});
        });
      });

      // localStorage-based cross-page sync removed
    })();

    // Reveal sequence, animate progress and navigate when done
    document.addEventListener('DOMContentLoaded', ()=>{
      const initials = document.getElementById('initials');
      const lead = document.getElementById('lead');
      const line2 = document.getElementById('line2');
      const progressWrap = document.getElementById('progressWrap');
      const progressBar = document.getElementById('progressBar');
      const progressIndicator = document.getElementById('progressIndicator');
      const heartBtn = document.getElementById('heartBtn');

      // reveal text
      requestAnimationFrame(()=>{ initials.style.opacity=1; initials.style.transform='translateY(0)'; });
      setTimeout(()=>{ lead.style.opacity=1; }, 300);
      setTimeout(()=>{ line2.style.opacity=1; }, 600);

      // reveal progress and animate to 100% then navigate
      setTimeout(()=>{
        progressWrap.style.opacity=1;
        // animate progress bar and indicator over 3.6s
        setTimeout(()=>{ progressBar.style.width='100%'; progressIndicator.style.left='100%'; }, 50);
        // navigate when finished (3.6s + small buffer)
        setTimeout(()=>{ window.location.href = 'advanced-invitation.html'; }, 3800 + 600);
      }, 900);

      // heart click navigates immediately
      heartBtn.addEventListener('click', ()=>{ window.location.href = 'advanced-invitation.html'; });
    });
  
    // Side particle generator
    (function(){
      const container = document.getElementById('sideParticles');
      if(!container) return;
      const types = ['heart','star'];
      const vw = Math.max(document.documentElement.clientWidth || 0, window.innerWidth || 0);
      const vh = Math.max(document.documentElement.clientHeight || 0, window.innerHeight || 0);

      function spawnParticle(i){
        const el = document.createElement('div');
        const type = types[Math.floor(Math.random()*types.length)];
        el.className = 'particle ' + type;
        // random start side (left or right)
        const leftSide = Math.random() > 0.5;
        const startY = Math.random() * vh * 0.9 + vh*0.05;
        el.style.top = startY + 'px';
        el.style.left = (leftSide ? -40 : vw - 10) + 'px';
        const duration = 6 + Math.random()*6; // 6-12s
        el.style.animation = (leftSide ? 'floatAcross' : 'floatAcrossLeft') + ' ' + duration + 's linear forwards';
        // size variation
        const s = 0.6 + Math.random()*1.2;
        el.style.transform = 'scale(' + s + ')';
        // slight delay
        el.style.animationDelay = (Math.random()*2) + 's';
        container.appendChild(el);
        // remove after animation
        setTimeout(()=> el.remove(), (duration+3)*1000);
      }

      // initial burst
      for(let i=0;i<10;i++){ setTimeout(()=> spawnParticle(i), i*350); }
      // continuous spawn
      setInterval(()=> spawnParticle(), 900);
    })();
  </script>

</body>
</html>
